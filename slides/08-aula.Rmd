---
class: inverse 
title: "<b>Metodologias Informacionais com R</b>"
subtitle: "<br/>Modulo IV: PNAD Contínua do IBGE"
author: "<br/><b>Telmo dos Santos Klipp</b> (telmo.klipp@inpe.br)<br/>"
output:
  xaringan::moon_reader:
    css: [default, ninjutsu, ki-fonts, my-theme.css]
    yolo: false
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      slideClass: ["left", "top"]
      slideNumberFormat: "%current%"
      ratio: '16:9' # 
---
layout: true

background-image: url(figures/template_middlepage_2.png)
background-size: cover

```{r libririesandcustoms, include=FALSE, warning=FALSE}
  library(xaringanthemer)
  library(icons)
  colors = c(
    red = "#f34213",
    purple = "#3e2f5b",
    orange = "#ff8811",
    green = "#136f63",
    white = "#FFFFFF",
    midnightblue = "#191970"
  )
```

---
### .orange[`r icons::fontawesome("info-circle")` Informações Gerais sobre o Curso]

- <p class="jst">Materiais disponibilizados via <A href="https://classroom.google.com/u/0/c/NjExMjg5MTU0OTY3">Classroom</A>;</p> 
- <p class="jst">O aprendizado requer a prática que será constante nas aulas;</p>

.pull-left[
Bibliografia Básica:

 .tiny2[- <p class="jst">Kennedy, R., & Waggoner, P. D. (2021). Introduction to r for social scientists: a tidy programming approach. CRC Press.</p>

```{r out.width = '39%', echo=FALSE, fig.align = "center"}
knitr::include_graphics("figures/basicblibliograph.png") 
```
]
]

.pull-right[
Bibliografia Complementar:

 .tiny2[- <p class="jst">Wickham, H., Çetinkaya-Rundel, M., & Grolemund, G. (2023). R for data science (2e): import, tidy, transform, visualize, and model data. "O'Reilly Media, Inc.". Disponível em: <A href="https://r4ds.hadley.nz/">https://r4ds.hadley.nz/</A>. Acesso em: 14 de junho, 2023. (Online) </p>
- <p class="jst">Damiani, A. et. al., (2022). Ciência de Dados em R. Curso-R. Disponível em: <A href="https://livro.curso-r.com">https://livro.curso-r.com</A>. Acesso em: 12 de maio, 2023. (Online)</p>
-  <p class="jst">de Aquino, J. A. (2014). R para cientistas sociais. Editora da UESC (editus). Disponível em: <A href="http://www.uesc.br/editora/index.php?item=conteudo_livros_digitais.php">http://www.uesc.br/editora/</A>. Acesso em: 12 de maio, 2023. </p>
-  <p class="jst">de Oliveira, P. F., Guerra, S., McDonnell, R. (2018). Ciência de Dados com R: Introdução. Editora IBPAD. Disponível em: <A href="https://cdr.ibpad.com.br/index.html">https://cdr.ibpad.com.br/index.html</A>. Acesso em: 12 de maio, 2023. (Online) </p> ] 
]

---
### .orange[`r icons::fontawesome("table")`Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")`]

<p class="jst">A <A href="https://www.ibge.gov.br/estatisticas/sociais/trabalho/17270-pnad-continua.html?=&t=o-que-e
">Pesquisa Nacional por Amostra de Domicílios Contínua (PNADC)</A>  realizada pelo Instituto Brasileiro de Geografia e Estatística (IBGE) visa:</p>

> <p class="jst"><i>"Acompanhar as flutuações trimestrais e a evolução, no curto, médio e longo prazos, da força de trabalho, e outras informações necessárias para o estudo do desenvolvimento socioeconômico do País."</i> (IBGE)</b> 

Algumas características da PNAD Contínua:

- <p class="jst">As pesquisas possuem periodicidade mensal (dada por trimestre móvel), trimestral, anual e variável (feita com maior periodicidade ou ocasionalmente).</p>
- <p class="jst">As pesquisas apresentam uma amostragem complexa.</p>

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")`]

<p class="jst">Para trabalhar com os microdados da PNAD Contínua vamos fazer uso dos pacotes: </p>

- <A href="https://cran.r-project.org/web/packages/PNADcIBGE/index.html">.purple[<b>PNADcIBGE</b>]</A> - possibilita baixar dados da PNAD Contínua.
- <A href="https://cran.r-project.org/web/packages/survey/index.html">.purple[<b>survey</b>]</A> - possibilita produzir diversas operações estatísticas em dados com amostragem complexa.
- <A href="https://cran.r-project.org/web/packages/srvyr/index.html">.purple[<b>srvyr</b>]</A> - uma extensão do pacote .purple[<b>survey</b>] que permite o uso de funções do .purple[<b>dplyr</b>] e sua sintaxe.


E necessário a instalação de:

```{r, message=FALSE, eval=FALSE}
  install.packages(c("PNADcIBGE", "survey", "srvyr", "tidyverse"))
  # Outros pacotes que serão usados
  install.packages(c("kableExtra", "patchwork"))
```

E carregar alguns dos referidos pacotes:

```{r, message=FALSE}
  library(PNADcIBGE)
  library(survey)
  library(tidyverse)
  library(kableExtra)
  library(patchwork)
```

```{r, echo=FALSE}
options(OutDec=",", scipen=100, digits=4, big.mark = ".")
```


---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - pacote .purple[<b>PNADcIBGE</b>]]

<p class="jst">Permite a importação e a análise de dados amostrais (microdados) da PNAD Contínua do IBGE. A importação ou carregamento de dados pode ser feita de duas formas:</p>

- <b>Online</b> - usando a função  .purple[get_pnadc()]
  - <p class="jst">Observe <b>?get_pnadc</b></p>
  - <p class="jst">Na requisição dos microdados com .purple[get_pnadc()] são baixados arquivos de um servidor <b>FTP</b> do IBGE. Estes são: o arquivo com os microdados e os arquivos com a documentação necessária ao processamento e leitura desses dados (<i>input</i>, dicionários, indicadores de deflação).</p> 
- <b>Offline</b> - (dados previamente baixados) - usando a função  .purple[read_pnadc()]
  - <p class="jst">Observe <b>?read_pnadc</b></p>
  - <p class="jst">Essa função permite ler diretamente o arquivo contendo os microdados, dado um arquivo de <i>input</i> (um programa de leitura na linguagem SAS) fornecido pelo IBGE.</p>

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - pacote .purple[<b>PNADcIBGE</b>]]

Existem divisões nos microdados da PNAD Contínua. Portanto, é possível baixá-los de quatro formas básicas:

- Dados trimestrais usando o parâmetro <b>quarter</b> que permite baixar um trimestre (1 à 4) por vez.
```{r, eval=FALSE}
  dados_2022q4 <- get_pnadc(year = 2022, quarter = 4)
```
- Dados anuais acumulados em determinada visita (entre a 1ª e 5ª cada vez) usando o parâmetro <b>interview</b>.
```{r, eval=FALSE}
  dados_2022_interview_1 <- get_pnadc(year = 2022, interview = 1)
```
- Dados anuais concentrados em determinado trimestre (entre o 1º e 4º cada vez) usando o parâmetro <b>topic</b>.
```{r, eval=FALSE}
  dados_2022_anual_trimestre <- get_pnadc(year=2022, topic=2)
```
- Dados de temas e tópicos suplementares (questionários específicos) aplicados a morador selecionado.
```{r, eval=FALSE}
  # Dados do módulo de Sensação de Segurança aplicado ao morador selecionado no 4º trimestre.
  dados_2022_anual_trimestre <- get_pnadc(year=2022, topic=4, selected=TRUE)
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - pacote .purple[<b>PNADcIBGE</b>]]

Outros argumentos da função .purple[get_pnadc()] são:

- <b>vars</b>: Permite carregar no R apenas variáveis específicas (obs: não funciona exatamente como o esperado).

```{r, eval=FALSE}
  # Obtendo as  variáveis:
  #  VD4001 - Condição em relação à força de trabalho
  #  VD4002 - Condição de ocupação
  dados_2022q4 <- get_pnadc(year = 2022, quarter = 4, vars=c("VD4001","VD4002"))
```
- <b>labels</b> (lógico `TRUE` ou `FALSE`): incluir ou não nomes categóricos nos valores de determinadas variáveis.

- <b>deflator</b> (lógico `TRUE` ou `FALSE`): incluir ou não as variáveis que permitem aplicar deflacionamento.

- <b>design</b> (lógico `TRUE` ou `FALSE`): retorna ou não os dados como objeto do tipo <b>`survey.design`</b>.

- <b>defyear</b> e <b>defperiod</b>: Ano ou trimestre considerados nas variáveis de deflacionamento, respectivamente. Se <b>defyear</b> ou <b>defperiod</b> forem indicados como `NULL` e o <b>deflator</b> como `TRUE`, serão considerado o ano mais recente, o ano ou o trimestre dos dados, conforme a alternativa de requisição de dados usada.

- <b>savedir</b>: Diretório para salvar os microdados e a documentação necessária ao processamento e leitura.

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - pacote .purple[<b>PNADcIBGE</b>]]

<p class="jst">Vamos trabalhar com microdados do primeiro trimestre de 2023. Para baixar os dados de um trimestre do servidor do IBGE através do pacote .purple[<b>PNADcIBGE</b>], procedemos na forma:</p>

```{r, cache=TRUE, eval=FALSE}
  pnadc_2023q1 <- get_pnadc(year = 2023, quarter = 1)
```

<p class="jst">Lembrando que como se trata de uma quantidade considerável de dados, podemos escolher carregar apenas variáveis específicas como  o ano (<b>Ano</b>), o trimestre (<b>Trimestre</b>),  a condição de ocupação (<b>VD4002</b>), entre outras:</p>

```{r, eval=FALSE}
  pnadc_2023q1 <- get_pnadc(year = 2023, quarter = 1,
                                  vars = c("Ano","Trimestre","UF","Capital","Estrato","UPA",
                                           "posest","V1027","V1028","V1029",
                                           "2003","V2009","VD3005","VD4002", 
                                           "ID_DOMICILIO","Habitual","Efetivo"))
  class(pnadc_2023q1)
```

<p class="jst">O objeto retornado é do tipo  <b>`survey.design`</b>, ou seja, inclui o plano amostral, bem como, os <i>labels</i> categóricos e as variáveis de deflacionamento.</p>

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - pacote .purple[<b>PNADcIBGE</b>]]

<p class="jst">Conforme mencionado, é possível carregar dados da PNAD Contínua diretamente (<i>offline</i>) com a função .purple[read_pnadc()], caso os dados já tenham sido baixados. Para isso basta informar o arquivo dos microdados (ex: PNADC_012023.txt) e o arquivo de <i>input</i> (um programa de leitura na linguagem SAS).</p>

```{r cache=TRUE, include=FALSE}
  # Lendo algumas variáveis
  pnadc_2023q1 <- read_pnadc(microdata="../dados/PNADC20231/PNADC_012023.txt",
                             input_txt="../dados/PNADC20231/input_PNADC_trimestral.txt",
                             vars = c("Ano", "Trimestre", "UF", "Capital", "Estrato", "UPA",
                                      "posest", "V1027", "V1028", "V1029",
                                      "V2009", "VD3005", "VD4002"))
  class(pnadc_2023q1)
```

```{r, cache=TRUE, eval=FALSE}
  pnadc_2023q1 <- read_pnadc(microdata="PNADC20231/PNADC_012023.txt",
                             input_txt="PNADC20231/input_PNADC_trimestral.txt",
                             vars = c("Ano", "Trimestre", "UF", "Capital", "Estrato", "UPA",
                                      "posest", "V1027", "V1028", "V1029",
                                      "V2009", "VD3005", "VD4002", "ID_DOMICILIO"))
  class(pnadc_2023q1)
```

<p class="jst">Nesse caso, os dados serão retornados em um objeto do tipo <b>tibble</b>. No entanto, o parâmetro <b>vars</b> não funciona como o esperado, ou seja, não filtra (limita) as variáveis que indicamos para nosso objeto. Portanto, resolveremos isso filtranto as variáveis com a função .purple[dplyr::select()], conforme:</p>

```{r cache=TRUE, cache=TRUE}
  pnadc_2023q1 <- pnadc_2023q1 |> 
    select(Ano, Trimestre, UF, Capital, Estrato, UPA,
           posest, V1027, V1028, V1029,
           V2003, V2009, VD3005, VD4002, ID_DOMICILIO) 
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - pacote .purple[<b>PNADcIBGE</b>]]

<p class="jst">Na filtragem, consideramos que  algumas das variáveis escolhidas são necessárias para aplicar as operações de deflacionamento e de construção do plano amostral. No caso dos dados trimestrais que carregamos (1° trimestre de 2023), estas variáveis são:</p>

- Domínios de projeção geográficos (<b>posest</b>).

- Peso do domicílio e das pessoas, sem calibração (<b>V1027</b>).

- Peso do domicílio e das pessoas, com calibração (<b>V1028</b>).

- Projeção da população por níveis geográficos (<b>V1029</b>).

- Número de ordem (<b>V2003</b>).

- Identificação do domicílio (<b>ID_DOMICILIO</b>).

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - pacote .purple[<b>PNADcIBGE</b>]]

<p class="jst">Agora, podemos aplicar as demais operações aos dados para:</p>

- <p class="jst">Obter os <i>labels</i> categóricos em determinadas variáveis.</p>
- <p class="jst">Obter as variáveis de deflacionamento.</p>
- <p class="jst">Transformar o objeto do tipo <b>tibble</b> em <b>survey.design</b>, caso seja de interesse obter estatísticas considerando o plano amostral com o pacote .purple[<b>survey</b>].</p> 

<p class="jst">Essas operações são possíveis através das funções .purple[pnadc_labeller()], .purple[pnadc_deflator()] e  .purple[pnadc_design()], sendo que ...</p>

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - pacote .purple[<b>PNADcIBGE</b>]]

<p class="jst">... procedemos na forma:</p>

```{r cache=TRUE, include=FALSE}
  # Atribuindo labels as variáveis categóricas
  pnadc_2023q1 <- pnadc_labeller(
    data_pnadc=pnadc_2023q1,
    dictionary.file="../dados/PNADC20231/dicionario_PNADC_microdados_trimestral.xls"
  )
  # Carregando indicadores de deflação caso deseja-se obter variáveis de rendimento
  # em valor real.
  pnadc_2023q1 <- pnadc_deflator(
    data_pnadc=pnadc_2023q1,
    deflator.file="../dados/PNADC20231/deflator_PNADC_2023_trimestral_040506.xls"
  )
  # Criação do plano amostral para obter estatísticas coerentes com pacote 'survey'
  pnadc_2023q1 <- pnadc_design(data_pnadc=pnadc_2023q1)
```

```{r cache=TRUE, eval=FALSE}
  # Atribuindo labels as variáveis categóricas
  pnadc_2023q1 <- pnadc_labeller(
    data_pnadc=pnadc_2023q1,
    dictionary.file="PNADC20231/dicionario_PNADC_microdados_trimestral.xls"
  )
  # Carregando indicadores de deflação caso deseja-se obter variáveis de rendimento
  # em valor real.
  pnadc_2023q1 <- pnadc_deflator(
    data_pnadc=pnadc_2023q1,
    deflator.file="PNADC20231/deflator_PNADC_2023_trimestral_040506.xls"
  )
  # Criação do plano amostral para obter estatísticas coerentes com pacote 'survey'
  pnadc_2023q1 <- pnadc_design(data_pnadc=pnadc_2023q1)
```

<p class="jst">Agora o objeto é do tipo  <b>`survey.design`</b>, ou seja, inclui o plano amostral, bem como, os <i>labels</i> categóricos e as variáveis de deflacionamento. Vejamos ...</p>

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - pacote .purple[<b>PNADcIBGE</b>]]

<p class="jst"> ... o tipo do nosso objeto:</p>

```{r, cache=TRUE, eval=TRUE}
  class(pnadc_2023q1)
```

Esse objeto é uma lista cujos elementos são:

```{r, cache=TRUE, eval=TRUE}
  names(pnadc_2023q1)
```

No item "variables" está o objeto <b>tibble</b> com os microdados. Os nomes das variáveis disponíveis podem ser obtidos com:

```{r, cache=TRUE, eval=FALSE}
  names(pnadc_2023q1$variables)
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - pacote .purple[<b>PNADcIBGE</b>]]

<p class="jst">Os arquivos de microdados e auxiliares (input, dicionários, indicadores de deflação) usados para aplicar as operações anteriores são fornecidos pelo IBGE.</p>

<p class="jst">Esses arquivos podem ser obtidos no <A href="https://www.ibge.gov.br/estatisticas/sociais/trabalho/17270-pnad-continua.html?=&t=downloads">.purple[site]</A> ou em servidor <b>ftp</b> do IBGE (<A href="https://ftp.ibge.gov.br">.purple[https://ftp.ibge.gov.br]</A>).</p>

<p class="jst">No entanto, é muito mais cômodo obtê-los fazendo uma requisição com a função .purple[get_pnadc()]. Nesse caso, não é necessário procurar os dados desejados na hierarquia de pastas do referido site ou do servidor <b>ftp</b>.</p>

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - pacote .purple[<b>PNADcIBGE</b>]]

<p class="jst">Relembrando:</p>

- A função  .purple[get_pnadc()] permite:
  - <p class="jst">Baixar os dados de servidor <b>FTP</b>.</p>
  - <p class="jst">Inclui por padrão <i>labels</i> categóricos, variáveis de deflacionamento e plano amostral. A não inclusão requer o uso de parâmetros específicos da função.</p> 
- A função  .purple[read_pnadc()] permite:
  - <p class="jst">Ler os microdados, requerendo arquivos específicos.</p>
  - <p class="jst">A inclusão de <i>labels</i> categóricos, variáveis de deflacionamento e plano amostral requer o uso de funções auxiliares.</p>
- O parâmetro <b>vars</b> não funcina como esperado:
  - <p class="jst">Ainda é possível filtrar os dados, porém, isso requer a identificação das variáveis que são necessárias para a aplicação de outras operações como deflacionamento e a construção do plano amostral, caso estas sejam desejadas.

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - pacote .purple[<b>PNADcIBGE</b>]]

<p class="jst"> O plano amostral é necessário para obter estatísticas coerentes e métricas sobre essas estatísticas como intervalos de confiança e margem de erro. Para maiores informações, veja as seguintes vídeo-aulas sobre microdados:</p>

- <A href="https://youtu.be/k3rLK8V_38s">.purple[Vídeo 1 - teórico]</A>

- <A href="https://www.youtube.com/watch?v=qC22jz0FA0U">.purple[Vídeo 2 - sobre PNADC]</A>

- <A href="https://www.youtube.com/watch?v=hhNA8MR__aA">.purple[Vídeo 3 - sobre Pesquisa de Orçamentos Familiares (POF)]</A>

<p class="jst"> O plano amostral da PNAD Contínua considera dois estágios de seleção com <b>estratificação</b> das unidades primárias de amostragem (UPAs). Não obstante, para produzir estatísticas coerentes sobre os dados, temos algumas opções:</p>

- <p class="jst">Usar o pacote .purple[<b>survey</b>], porém, seu objeto do tipo lista não permitirá operações usando o .purple[<b>dplyr</b>], devendo-se usar outras opções para manipulação de dados.</p>
- <p class="jst">Considerar as devidas métricas do plano amostral como, por exemplo, aplicar manualmente os devidos pesos da estratificação em funções pertinentes para gerar as estatíticas desejadas.</p>
- <p class="jst">Usar de forma combinada o pacote .purple[<b>survey</b>] e .purple[<b>srvyr</b>] o que permitirá o uso de funções do .purple[<b>dplyr</b>] e consequente flexibilidade nas manipulações de dados.</p>

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>survey</b>]]

<p class="jst">O objeto do tipo <b>survey.design</b> permite produzir estatísticas através de funções do pacote .purple[<b>survey</b>]. Vejamos:</p>

Qual a taxa de Ocupados/Desocupados em nível nacional?

```{r, cache=TRUE}
  svymean(~VD4002, pnadc_2023q1, na.rm=T)
```

Como gerar intervalos de confiança da proporção de Ocupados/Desocupados?

```{r, cache=TRUE}
  confint(svymean(~VD4002, pnadc_2023q1, na.rm=T), level=.99)
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>survey</b>]]

Qual a taxa de Ocupados/Desocupados no Rio Grande do Sul?

```{r, cache=TRUE}
  svymean(~VD4002, subset(pnadc_2023q1, UF=='Rio Grande do Sul'), na.rm=T)
```

Como gerar intervalos de confiança da proporção de Ocupados/Desocupados?

```{r, cache=TRUE}
  confint(svymean(~VD4002, subset(pnadc_2023q1, UF=='Rio Grande do Sul'), na.rm=T), level=.99)
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>survey</b>]]

Qual o total de Ocupados/Desocupados no Rio Grande do Sul?

```{r, cache=TRUE}
  svytotal(~VD4002, subset(pnadc_2023q1, UF=='Rio Grande do Sul'), na.rm=T)
```

Como gerar intervalos de confiança do total de Ocupados/Desocupados?

```{r, cache=TRUE}
  confint(svytotal(~VD4002, subset(pnadc_2023q1, UF=='Rio Grande do Sul'), na.rm=T), level=.99)
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>survey</b>]]

<p class="jst">A variável <b>V2009</b> refere-se a idade dos entrevistados, enquanto <b>VD3005</b> é uma variável categórica referente a quantidade de anos de estudo. É possível extrair a informação da quantidade de anos de estudo do texto de cada categória, conforme:</p>

```{r, cache=TRUE}
  data.frame(VD3005 = pnadc_2023q1$variables$VD3005 ,
             qtd = gsub("\\D", "", pnadc_2023q1$variables$VD3005)) |> 
  unique() |> 
  kable() |> 
  kable_styling(bootstrap_options = c('striped', 'condensed')) |>
  scroll_box(width = "1050px", height = "240px")
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>survey</b>]]

<p class="jst"> Perceba que a categória "<b>Sem instrução e menos de 1 ano de estudo</b>" é convertida para 1 ano de estudo, assim, será excluída. Portanto, qual é a média de anos de estudos da população de 25 anos ou mais de idade no Rio Grande do Sul?</p>

```{r, cache=TRUE}
  svymean(~as.numeric(gsub("\\D", "", VD3005)), 
          subset(pnadc_2023q1, V2009 >= 25 & UF=='Rio Grande do Sul' 
                 & VD3005 != "Sem instrução e menos de 1 ano de estudo"), na.rm = T)
```

```{r, cache=TRUE}
  confint(svymean(~as.numeric(gsub("\\D", "", VD3005)),
                  subset(pnadc_2023q1, V2009 >= 25 & UF=='Rio Grande do Sul'
                         & VD3005 != "Sem instrução e menos de 1 ano de estudo"), na.rm = T),
          level=.99)
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>survey</b>]]

 Qual é a média de anos de estudos da população de 25 anos ou mais de idade na capital Porto Alegre?
 
```{r, cache=TRUE}
  svymean(~as.numeric(gsub("\\D", "", VD3005)),
          subset(pnadc_2023q1, V2009 >= 25 & Capital=="Município de Porto Alegre (RS)"
                 & VD3005 != "Sem instrução e menos de 1 ano de estudo"), na.rm = T)
```

```{r, cache=TRUE}
  confint(svymean(~as.numeric(gsub("\\D", "", VD3005)), 
                  subset(pnadc_2023q1, V2009 >= 25 & Capital=="Município de Porto Alegre (RS)"
                         & VD3005 != "Sem instrução e menos de 1 ano de estudo"), na.rm = T),
          level=.99)
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>survey</b>]]

 O pacote .purple[<b>survey</b>] possui algumas funções para gerar gráficos. Por exemplo:
 
```{r, cache=TRUE}
  svyhist(formula=~V2009, design=pnadc_2023q1, main="Histograma", xlab="Idade do morador na data de referência")
```
 
---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas manualmente]

Nos próximos exemplos trabalharemos com os seguintes dados:

```{r, eval=FALSE}
  pnadc2023_1trim <- get_pnadc(2023, quarter = 1, design = FALSE, labels = T, 
                             vars = c("Ano","Trimestre","UF", "RM_RIDE", "Capital","UPA",
                                      "Estrato", "posest", "V1027","V1028", "V1029",
                                      "V2003","V2007","V2009","V2010",
                                      "V3007","VD3004","VD3005","VD4020",
                                      "Habitual", "Efetivo"))
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas manualmente]

Para carregar diretamente:

```{r cache=TRUE, include=FALSE}
  pnadc2023_1trim <- read_pnadc(microdata="../dados/PNADC20231/PNADC_012023.txt",
                             input_txt="../dados/PNADC20231/input_PNADC_trimestral.txt",
                             vars = c("Ano","Trimestre","UF", "RM_RIDE", "Capital","UPA",
                                      "Estrato", "posest", "V1027","V1028", "V1029",
                                      "V2003","V2007","V2009","V2010",
                                      "V3007","VD3004","VD3005","VD4020"))
  pnadc2023_1trim <- pnadc2023_1trim  |>
    select(Ano, Trimestre, UF, RM_RIDE, Capital, UPA, Estrato, posest, V1027, V1028, V1029,
           V2003, V2007, V2009, V2010, VD3004, VD3005, VD4020, ID_DOMICILIO) |>
    mutate(code_state = as.numeric(UF))
  pnadc2023_1trim <- pnadc_labeller(
    data_pnadc=pnadc2023_1trim,
    dictionary.file="../dados/PNADC20231/dicionario_PNADC_microdados_trimestral.xls"
  )
  pnadc2023_1trim <- pnadc_deflator(
    data_pnadc=pnadc2023_1trim,
    deflator.file="../dados/PNADC20231/deflator_PNADC_2023_trimestral_040506.xls"
  )
```

```{r cache=TRUE, eval=FALSE}
  # Ler os dados
  pnadc2023_1trim <- read_pnadc(microdata="PNADC20231/PNADC_012023.txt",
                             input_txt="PNADC20231/input_PNADC_trimestral.txt",
                             vars = c("Ano","Trimestre","UF", "RM_RIDE", "Capital","UPA",
                                      "Estrato", "posest", "V1027","V1028", "V1029",
                                      "V2003","V2007","V2009","V2010",
                                      "V3007","VD3004","VD3005", 
                                      "VD4001","VD4002","VD4005","VD4020"))
  # Filtrar as variáveis desejadas
  pnadc2023_1trim <- pnadc2023_1trim  |>
    select(Ano, Trimestre, UF, RM_RIDE, Capital, UPA, Estrato, posest, V1027, V1028, V1029,
           V2003, V2007, V2009, V2010, VD3004, VD3005, VD4020, ID_DOMICILIO) |>
    mutate(code_state = as.numeric(UF))
```

Para atribuir <i>labels</i> categóricos e obter variáveis de deflação ...

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas manualmente]

```{r cache=TRUE, eval=FALSE}
  # obtendo labels categóricos e variáveis de deflação
  pnadc2023_1trim <- pnadc_labeller(
    data_pnadc=pnadc2023_1trim,
    dictionary.file="PNADC20231/dicionario_PNADC_microdados_trimestral.xls" 
  )
  pnadc2023_1trim <- pnadc_deflator(
    data_pnadc=pnadc2023_1trim,
    deflator.file="PNADC20231/deflator_PNADC_2023_trimestral_040506.xls"
  )
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas manualmente]

```{r, cache=TRUE}
  rendimento_mensal_estados <- pnadc2023_1trim |> 
    filter(VD3005 != "Sem instrução e menos de 1 ano de estudo") |>
    mutate(anos_de_estudo = as.numeric(gsub("\\D", "", VD3005))) |>
    summarise("rendimento_medio" = weighted.mean(VD4020, w = V1028, na.rm = TRUE),
              "anos_de_estudo" = weighted.mean(anos_de_estudo, w = V1028, na.rm = TRUE),
              .by = "UF") |>
    drop_na() |>
    arrange(desc(rendimento_medio))
  rendimento_mensal_estados |> kable() |> 
    kable_styling(bootstrap_options = c('striped', 'condensed')) |>
    scroll_box(width = "1050px", height = "210px")
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas manualmente]

.pull-left[
<p class="jst">Rendimento médio mensal e anos de estudo por estados.</p>

```{r p1a, message=FALSE, eval=FALSE}
  dt <- rendimento_mensal_estados |>
    mutate(
      UF=fct_reorder(UF,
                          rendimento_medio)
    )
   p <- ggplot(dt) + theme_classic()
   p1 <- p + geom_col(aes(rendimento_medio,
                          UF))
   p2 <- p + geom_col(aes(anos_de_estudo,
                          UF)) +
     theme(axis.text.y = element_blank(),
           axis.title.y = element_blank())
   p1 + p2
```
]

.pull-right[
```{r p1a_out, ref.label="p1a", echo=FALSE, warning=FALSE, message=FALSE}
```
]

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas manualmente]

.pull-left[
<p class="jst">Rendimento médio mensal por anos de estudo em nível estadual.</p>
```{r p1b, message=FALSE, eval=FALSE}
  rendimento_mensal_estados |> 
    ggplot(aes(anos_de_estudo,
               rendimento_medio)) +
    geom_point() + theme_classic()
```
]

.pull-right[
```{r p1b_out, ref.label="p1b", echo=FALSE, warning=FALSE, message=FALSE}
```
]

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas manualmente]

```{r, cache=TRUE}
  rendimento_mensal_capitais <- pnadc2023_1trim |>
    filter(VD3005 != "Sem instrução e menos de 1 ano de estudo") |>
    mutate(anos_de_estudo = as.numeric(gsub("\\D", "", VD3005))) |>
    summarise("rendimento_medio" = weighted.mean(VD4020, w = V1028, na.rm = TRUE),
              "anos_de_estudo" = weighted.mean(anos_de_estudo, w = V1028, na.rm = TRUE),
              .by = "Capital") |>
    tidyr::drop_na() |>
    arrange(desc(rendimento_medio))
  rendimento_mensal_capitais |> kable() |> 
    kable_styling(bootstrap_options = c('striped', 'condensed')) |>
    scroll_box(width = "1050px", height = "210px")
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas manualmente]

.pull-left[
<p class="jst">Rendimento médio mensal e anos de estudo nas capitais.</p>
```{r p2a, message=FALSE, eval=FALSE}
  dt <- rendimento_mensal_capitais |>
    mutate(
      Capital=fct_reorder(Capital,
                          rendimento_medio)
    )
   p <- ggplot(dt) + theme_classic()
   p1 <- p + geom_col(aes(rendimento_medio,
                          Capital))
   p2 <- p + geom_col(aes(anos_de_estudo,
                          Capital)) +
     theme(axis.text.y = element_blank(),
           axis.title.y = element_blank())
   p1 + p2 
```
]

.pull-right[
```{r p2a_out, ref.label="p2a", echo=FALSE, warning=FALSE, message=FALSE}
```
]

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas manualmente]

.pull-left[
<p class="jst">Rendimento médio mensal por anos de estudo considerando as capitais.</p>
```{r p2b, message=FALSE, eval=FALSE}
  rendimento_mensal_capitais |> 
    ggplot(aes(anos_de_estudo,
               rendimento_medio)) +
    geom_point() + theme_classic()
```
]

.pull-right[
```{r p2b_out, ref.label="p2b", echo=FALSE, warning=FALSE, message=FALSE}
```
]

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>srvyr</b>]]

Vamos usar de forma combinada .purple[<b>survey</b>] e .purple[<b>srvyr</b>]. Antes, necessitamos carregar o pacote .purple[<b>srvyr</b>]:

```{r, message=FALSE}
  library(srvyr)
```

Agora aplicaremos o plano amostral nos nossos dados:

```{r, message=FALSE}
  pnadc2023_1trim <- pnadc_design(data_pnadc=pnadc2023_1trim)
  class(pnadc2023_1trim)
```

E tranformaremos novamente o objeto, conforme:

```{r, message=FALSE}
  pnadc2023_1trim <- srvyr::as_survey(pnadc2023_1trim)
  class(pnadc2023_1trim)
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>srvyr</b>]]

Esse objeto continua sendo uma lista cujos elementos são:

```{r, cache=TRUE, eval=TRUE}
  names(pnadc2023_1trim)
```

No item "variables" está o objeto <b>tibble</b> com os microdados, as variáveis disponíveis são:

```{r, cache=TRUE, eval=FALSE}
  names(pnadc2023_1trim$variables)
```

Observe que é possível usar funções do pacote .purple[<b>dplyr</b>] no novo objeto:

```{r, cache=TRUE, eval=FALSE}
  glimpse(pnadc2023_1trim)
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>srvyr</b>]]

```{r, cache=TRUE}
  rendimento_mensal_estados <- pnadc2023_1trim |>
    group_by(UF) |>
    summarise(rendimento_medio = survey_mean(VD4020, na.rm = T, vartype = "ci"))
    rendimento_mensal_estados |>
  kable() |> 
    kable_styling(bootstrap_options = c('striped', 'condensed')) |>
    scroll_box(width = "1050px", height = "250px")
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>srvyr</b>]]

.pull-left[
<p class="jst">Rendimento médio mensal por estados.</p>
```{r p3a, message=FALSE, eval=FALSE}
  rendimento_mensal_estados |> 
    ggplot(aes(UF, rendimento_medio)) +
    geom_point() +
    geom_errorbar(
      aes(ymin = rendimento_medio_low,
          ymax = rendimento_medio_upp),
      width = 0.2) +
    theme_classic() +
    theme(
      axis.text.x = element_text(angle = 90)
    )
```
]

.pull-right[
```{r p3a_out, ref.label="p3a", echo=FALSE, warning=FALSE, message=FALSE}
```
]

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>srvyr</b>]]


```{r, cache=TRUE, warning=FALSE}
  proporcao_nivel_estudo <- pnadc2023_1trim |>
    group_by(V2007, VD3004) |>
    summarise(frequencia = survey_mean())
  proporcao_nivel_estudo |> 
    kable() |> 
    kable_styling(bootstrap_options = c('striped', 'condensed')) |>
    scroll_box(width = "1050px", height = "250px")
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>srvyr</b>]]

.pull-left[
<p class="jst">Proporção da população, entre os entrevistados, em cada nível de estudo.</p>
```{r p4a, message=FALSE, eval=FALSE}
  proporcao_nivel_estudo |> 
    mutate(
      nivel_de_estudo = fct_reorder(
        VD3004, frequencia
      )
    ) |>
    drop_na() |>
    ggplot(aes(frequencia * 100,
               nivel_de_estudo)) +
    geom_col() +
    facet_wrap(~V2007, nrow = 2) +
    theme_minimal()
```
]

.pull-right[
```{r p4_out, ref.label="p4a", echo=FALSE, warning=FALSE, message=FALSE}
```
]

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>srvyr</b>]]

<b>Exercício 1:</b> Gere o rendimento médio mensal por estado e segundo a variável <b>V2007</b> usando o pacote .purple[<b>srvyr</b>]. Faça isso considerando operações do .purple[<b>dplyr</b>].

```{r, cache=TRUE, warning=FALSE}
  rendimento_mensal <- pnadc2023_1trim |>
    group_by(UF, V2007) |>
    summarise("rendimento_medio" = survey_mean(VD4020, na.rm = TRUE)) |>
    tidyr::drop_na() |> 
    arrange(UF)
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>srvyr</b>]]

<b>Exercício 1:</b>

```{r}
  rendimento_mensal |>
    kable() |> 
    kable_styling(bootstrap_options = c('striped', 'condensed')) |>
    scroll_box(width = "1050px", height = "250px")
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>srvyr</b>]]

<b>Exercício 1:</b> Gere gráficos de colunas do rendimento médio segundo a variável <b>V2007</b>, conforme:

```{r echo=FALSE, cache=TRUE, fig.align='center', out.height='450px', out.width='700px'}
  rendimento_mensal |> 
    ggplot(aes(UF, rendimento_medio)) +
    geom_col() +
    facet_wrap(~V2007, nrow = 1) +
    theme_minimal() + 
    theme(axis.text.x = element_text(angle = 90))
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>srvyr</b>]]

<b>Exercício 2:</b> Gere médias para o rendimento mensal e anos de estudo, conforme a tabela abaixo. Agrupe os dados por estado e pela variável <b>V2007</b>. Use os pacotes .purple[<b>srvyr</b>] e .purple[<b>dplyr</b>].

```{r warning=FALSE, cache=TRUE, include=FALSE}
  rendimento_mensal <- pnadc2023_1trim |>
    filter(VD3005 != "Sem instrução e menos de 1 ano de estudo") |>
    mutate(anos_de_estudo = as.numeric(gsub("\\D", "", VD3005))) |> 
    group_by(UF, V2007) |>
    summarise("rendimento_medio" = survey_mean(VD4020, na.rm = TRUE, vartype = "ci"),
              "anos_de_estudo" = survey_mean(anos_de_estudo, na.rm = TRUE),
    ) |>
    tidyr::drop_na() |> arrange(UF)
```

```{r}
  rendimento_mensal |>
    kable() |> 
    kable_styling(bootstrap_options = c('striped', 'condensed')) |>
    scroll_box(width = "1050px", height = "250px")
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>srvyr</b>]]

<b>Exercício 2:</b> Gere gráficos de dispersão do rendimento médio por anos de estudo, segundo a variável <b>V2007</b>, conforme:

```{r echo=FALSE, cache=TRUE, fig.align='center', out.height='430px', out.width='700px'}
  rendimento_mensal |> 
    ggplot(aes(anos_de_estudo, rendimento_medio)) +
    geom_point() +
    facet_wrap(~V2007, nrow = 2) +
    theme_minimal()
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>srvyr</b>]]

<b>Exercício 2:</b> Gere sub-gráficos (segundo <b>V2007</b>) contendo o rendimento médio mensal para cada estado e intervalo de confiança, conforme:

```{r, message=FALSE, echo=FALSE, fig.align='center', out.height='430px', out.width='500px'}
  rendimento_mensal |> 
    ggplot(aes(rendimento_medio, UF)) +
    geom_point() +
    geom_errorbar(
      aes(xmin = rendimento_medio_low,
          xmax = rendimento_medio_upp),
      width = 0.2) +
    facet_wrap(~V2007, nrow = 2) +
    theme_classic()
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>srvyr</b>]]

<b>Exercício 3:</b> Compute o rendimento mensal por nível de estudo (<b>VD3004</b>), conforme a tabela abaixo. Agrupe os dados por estados. Use o pacote .purple[<b>srvyr</b>].


```{r warning=FALSE, cache=TRUE, include=FALSE}
  rendimento_mensal <- pnadc2023_1trim |>
    group_by(UF, VD3004) |>
    summarise("rendimento_medio" = survey_mean(VD4020, na.rm = TRUE, vartype = "ci")) |>
    tidyr::drop_na() |> arrange(UF)
```

```{r}
  rendimento_mensal |>
    kable() |> 
    kable_styling(bootstrap_options = c('striped', 'condensed')) |>
    scroll_box(width = "1050px", height = "250px")
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - estatísticas com .purple[<b>srvyr</b>]]

<b>Exercício 3:</b> Gere gráficos de colunas (para cada estado) do rendimento médio por nível de estudo, conforme:

```{r echo=FALSE, cache=TRUE, fig.align='center', out.height='430px', out.width='800px'}
  rendimento_mensal |> 
    ggplot(aes(rendimento_medio, VD3004)) +
    geom_col() +
    facet_wrap(~UF) +
    theme_minimal() +
    theme(axis.title.y = element_blank(), axis.text.x = element_text(angle = 90), strip.text = element_text(size = 7))
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - visualização espacial]

Considere os seguintes pacotes:

```{r, message=FALSE}
  library(geobr)
  library(sf)
  library(ggspatial)
```

Vamos carregar um mapa do brasil com a subdivisão dos estados:

```{r, cache=TRUE, message=FALSE}
  states <- read_state( year = 2020, showProgress = FALSE)
```

```{r, cache=TRUE}
  glimpse(states)
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - visualização espacial]

<p class="jst">Vamos calcular novamente o rendimento médio mensal conforme o Exercício 3, só que dessa vez, agruparemos os dados considerando a variável <b>code_state</b>.</p>

```{r, cache=TRUE, warning=FALSE}
  rendimento_mensal <- pnadc2023_1trim |>
    group_by(code_state, VD3004) |>
    summarise("rendimento_medio" = survey_mean(VD4020, na.rm = TRUE, vartype = "ci")) |>
    tidyr::drop_na()
```

```{r, cache=TRUE}
  glimpse(rendimento_mensal)
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - visualização espacial]

Agora adicionaremos os dados de rendimento médio mensal ao conjunto de dados do mapa.

```{r, cache=TRUE}
  states <- dplyr::left_join(states, rendimento_mensal, by = "code_state")
```

<p class="jst">Finalmente podemos produzir um mapa usando o .purple[ggplot2], conforme:</p>

```{r p1, message=FALSE, eval=FALSE}
  titulo <- "Rendimento médio mensal para indivíduos com nível superior completo,\nno primeiro trimestre de 2023"
  states |> filter(VD3004 == "Superior completo") |> ggplot() +
    geom_sf(data=states, aes(fill=rendimento_medio), color=NA) +
    labs(subtitle = titulo, size=8) +
    scale_fill_distiller(palette = "Spectral", name="Rendimento Médio") +
    theme_minimal() + 
    ggspatial::annotation_scale()
```

---
class: left, top
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - visualização espacial]

```{r p1_out, ref.label="p1", echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', out.height= "500px", out.width="800px"}
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - visualização espacial]

<p class="jst">Finalmente podemos produzir um mapa usando o .purple[ggplot2], conforme:</p>

```{r p2, message=FALSE, eval=FALSE}
  states |> ggplot() +
    geom_sf(data=states, aes(fill=rendimento_medio), color=NA) + 
    facet_wrap(~VD3004) +
    labs(subtitle="Rendimento médio mensal, no primeiro trimestre de 2023", size=8) +
    scale_fill_distiller(palette = "Spectral", name="Rendimento Médio") +
    theme_classic() +
    theme(axis.text = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          strip.text = element_text(size = 6))
```

---
class: left, top
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")` - visualização espacial]

```{r p2_out, ref.label="p2", echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', out.height= "500px", out.width="800px"}
```

---
### .orange[Microdados da PNAD Contínua `r icons::ionicons("bar-chart-outline")`]

<p class="jst">Há uma diversidade de bons materiais que orientam o uso dos microdados da PNAD Contínua através do R: </p>

- <p class="jst">Material <A href="https://rpubs.com/gabriel-assuncao-ibge/pnadc">.purple[online]</A> desenvolvido por um dos criadores do pacote .purple[<b>PNADcIBGE</b>].

- <p class="jst"> Livro  <A href="https://repositorio.ufrn.br/bitstream/123456789/48507/1/PorDentrodaPNADContinua_Trov%C3%A3o_SilvaJ%C3%BAnior_2022.pdf">.purple["POR DENTRO DA PNAD CONTÍNUA: Uma introdução ao tratamento de dados usando o R"]</A>.
- <p class="jst">Curso de R disponível no repositório do Git Hub: <A href="https://github.com/leobarone/cebrap_lab_cetic_programacao_r/tree/master">.purple[Introdução à Programação em R]</b></A>. 
- <p class="jst">Material <A href="https://rpubs.com/amrofi/microdados_pnadc_srvyr/">.purple[online]</A>.

---
exclude: TRUE
class: left, top

### .orange[Referências]

```{r, load_refs, echo=FALSE}
library(RefManageR)
bib <- ReadBib("./files/02-mybib.bib", check = FALSE)
generateReferences <- function(bib) {
  for(i in 1:length(bib)) { 
    print(bib[i], .opts = list(check.entries = FALSE, style = "html", bib.style = "authoryear"))
  }
}
```

```{r, print_refs, results='asis', echo=FALSE, warning=FALSE, message=FALSE}
writeLines('.small[')
generateReferences(bib)
writeLines(']')
```

---
class: center, middle

background-image: url(figures/template_endpage_2.png)
background-size: contain

.center[.large[<b> Metotologias Informacionais com `r icon_style( icons::simple_icons("r"), scale = 2)`</b> ]]

.xxlarge[<b style="color:MidnightBlue "> Muito Obrigado pela Atenção!</b>]
  
